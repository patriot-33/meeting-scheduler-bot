#!/usr/bin/env python3
"""Final fixes for remaining syntax errors."""

# Fix src/handlers/common.py
with open('src/handlers/common.py', 'r', encoding='utf-8') as f:
    content = f.read()

# Fix line 65 - wrong quotes
content = content.replace('"" AB@5G8 ?@>2>4OBAO @07 2 2 =545;8', '"‚Ä¢ –í—Å—Ç—Ä–µ—á–∏ –ø—Ä–æ–≤–æ–¥—è—Ç—Å—è —Ä–∞–∑ –≤ 2 –Ω–µ–¥–µ–ª–∏')
content = content.replace('"" >ABC?=K5 G0AK:', '"‚Ä¢ –î–æ—Å—Ç—É–ø–Ω—ã–µ —á–∞—Å—ã:')
content = content.replace('"" @>4>;68B5;L=>ABL:', '"‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:')
content = content.replace('"" 0?><8=0=8O ?@8E>4OB 02B><0B8G5A:8', '"‚Ä¢ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏')

# Fix other corrupted text
content = content.replace('B<5B8BL :><0=48@>2:C', '–û—Ç–º–µ—Ç–∏—Ç—å –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫—É')
content = content.replace('5@=CBLAO 2–ê–∫—Ç–∏–≤–Ω—ã–π AB0BCA', '–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∞–∫—Ç–∏–≤–Ω—ã–π —Å—Ç–∞—Ç—É—Å')
content = content.replace('=d **@>D8;L:**', 'üë§ **–ü—Ä–æ—Ñ–∏–ª—å:**')
content = content.replace('>A<>B@5BL <–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å', '–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å')
content = content.replace('9 **A>15==>AB8:**', 'üìù **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**')
content = content.replace('> –ü–æ–º–æ—â—å ?> 1>BC', 'ü§ñ –ü–æ–º–æ—â—å –ø–æ –±–æ—Ç—É')
content = content.replace('=K @825B, ', '–ü—Ä–∏–≤–µ—Ç, ')
content = content.replace('=K @825B! / 1>B 4;O ?;0=8@>20=8O 2AB@5G.', '–ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å—Ç—Ä–µ—á.')
content = content.replace('=ÔøΩ ', 'üìã ')
content = content.replace('L ?5@0F8O >B<5=5=0.', '–û–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞.')
content = content.replace('A?>;L7C9B5 /help 4;O ?@>A<>B@0 4>ABC?=KE :><0=4.', '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥.')
content = content.replace('ÔøΩ >72@0I05<AO =0704...', '‚¨ÖÔ∏è –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞–∑–∞–¥...')

with open('src/handlers/common.py', 'w', encoding='utf-8') as f:
    f.write(content)

print("‚úÖ Fixed src/handlers/common.py")

# Fix src/handlers/manager.py
with open('src/handlers/manager.py', 'r', encoding='utf-8') as f:
    content = f.read()

# Fix line 224-225 issue
content = content.replace('>7\nB # 20A =5B 70?;0=8@>20==KE 2AB@5G.', 'üìÖ –£ –≤–∞—Å –Ω–µ—Ç –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤—Å—Ç—Ä–µ—á.')

# Fix other corrupted text in manager.py
corrupted_replacements = {
    'ÔøΩ K =0E>48B5AL =0 ': '‚ùå –í—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ —Å—Ç–∞—Ç—É—Å–µ ',
    ';O =07=0G5=8O 2AB@5G A=0G0;0 25@=8B5AL 2–ê–∫—Ç–∏–≤–Ω—ã–π AB0BCA:': '–î–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –≤—Å—Ç—Ä–µ—á —Å–Ω–∞—á–∞–ª–∞ –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –∞–∫—Ç–∏–≤–Ω—ã–π —Å—Ç–∞—Ç—É—Å:',
    '=  A>60;5=8N, =0 1;8609H85 4 =545;8 =5B A2>1>4=KE A;>B>2.': 'üòî –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–µ 4 –Ω–µ–¥–µ–ª–∏ –Ω–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤.',
    '>?@>1C9B5 ?>765 8;8 A2O68B5AL A 04<8=8AB@0B>@><.': '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º.',
    '=ÔøΩ >ABC?=K5 A;>BK 4;O 2AB@5G': 'üìÖ –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ª–æ—Ç—ã –¥–ª—è –≤—Å—Ç—Ä–µ—á',
    '= 0 4>ABC?=K5 4=8 =5B A2>1>4=KE A;>B>2.': '‚ùå –ù–∞ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–Ω–∏ –Ω–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤.',
    'ÔøΩ @>87>H;0 >H81:0 ?@8 ?>;CG5=88 4>ABC?=KE A;>B>2. >?@>1C9B5 ?>765.': '‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.',
    'ÔøΩ 5;L7O =07=0G8BL 2AB@5GC 2 =50:B82=>< AB0BCA5.': '‚ùå –ù–µ–ª—å–∑—è –Ω–∞–∑–Ω–∞—á–∏—Ç—å –≤—Å—Ç—Ä–µ—á—É –≤ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–º —Å—Ç–∞—Ç—É—Å–µ.',
    'ÔøΩ # 20A C65 5ABL 70?;0=8@>20==0O 2AB@5G0.': '‚ùå –£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—Å—Ç—Ä–µ—á–∞.',
    '!;54CNICN 2AB@5GC <>6=> =07=0G8BL =5 @0=55 ': '–°–ª–µ–¥—É—é—â—É—é –≤—Å—Ç—Ä–µ—á—É –º–æ–∂–Ω–æ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –Ω–µ —Ä–∞–Ω–µ–µ ',
    'ÔøΩ  A>60;5=8N, MB>B A;>B C65 70=OB. >?@>1C9B5 2K1@0BL 4@C3>5 2@5<O.': '‚ùå –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —ç—Ç–æ—Ç —Å–ª–æ—Ç —É–∂–µ –∑–∞–Ω—è—Ç. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–µ –≤—Ä–µ–º—è.',
    '=ÔøΩ >20O 2AB@5G0': 'üìÖ –ù–æ–≤–∞—è –≤—Å—Ç—Ä–µ—á–∞',
    '=ÔøΩ 0H8 70?;0=8@>20==K5 2AB@5G8:': 'üìÖ –í–∞—à–∏ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤—Å—Ç—Ä–µ—á–∏:',
    ' AB@5G0 CA?5H=> =07=0G5=0!': '‚úÖ –í—Å—Ç—Ä–µ—á–∞ —É—Å–ø–µ—à–Ω–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∞!',
    '=ÔøΩ 0B0:': 'üìÖ –î–∞—Ç–∞:',
    'ÔøΩ @5<O:': 'üïê –í—Ä–µ–º—è:',
    '= K ?>;CG8B5 =0?><8=0=85 70 1 G0A 4> 2AB@5G8.': 'üí° –í—ã –ø–æ–ª—É—á–∏—Ç–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∑–∞ 1 —á–∞—Å –¥–æ –≤—Å—Ç—Ä–µ—á–∏.',
    'ÔøΩ @>87>H;0 >H81:0 ?@8 =07=0G5=88 2AB@5G8. >?@>1C9B5 ?>765.': '‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ –≤—Å—Ç—Ä–µ—á–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.',
    'L B<5=8BL ': '‚ùå –û—Ç–º–µ–Ω–∏—Ç—å ',
    'ÔøΩ AB@5G0 =5 =0945=0.': '‚ùå –í—Å—Ç—Ä–µ—á–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.',
    'L AB@5G0 >B<5=5=0': '‚úÖ –í—Å—Ç—Ä–µ—á–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞',
    '>65B5 =07=0G8BL =>2CN 2AB@5GC G5@57 /schedule': '–ú–æ–∂–µ—Ç–µ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –Ω–æ–≤—É—é –≤—Å—Ç—Ä–µ—á—É —á–µ—Ä–µ–∑ /schedule',
    ' 0H AB0BCA 87<5=5= =0:': '‚úÖ –í–∞—à —Å—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–µ–Ω –Ω–∞:',
    '=ÔøΩ <O:': 'üë§ –ò–º—è:',
    '<ÔøΩ B45;:': 'üè¢ –û—Ç–¥–µ–ª:',
    '!B0BCA:': '–°—Ç–∞—Ç—É—Å:',
    '=ÔøΩ **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**': 'üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**',
    '‚Ä¢ A53> 2AB@5G:': '‚Ä¢ –í—Å–µ–≥–æ –≤—Å—Ç—Ä–µ—á:',
    '‚Ä¢ @>2545=>:': '‚Ä¢ –ü—Ä–æ–≤–µ–¥–µ–Ω–æ:',
    '‚Ä¢ >A;54=OO 2AB@5G0:': '‚Ä¢ –ü–æ—Å–ª–µ–¥–Ω—è—è –≤—Å—Ç—Ä–µ—á–∞:',
    '=d **–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å**': 'üë§ **–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å**',
    '">BC': 'ü§ñ –ü–æ–º–æ—â—å –ø–æ –±–æ—Ç—É',
    '–í –æ—Ç–ø—É—Å–∫–µ5': '–í –æ—Ç–ø—É—Å–∫–µ',
    "> 1>;L=8G=><": '–ù–∞ –±–æ–ª—å–Ω–∏—á–Ω–æ–º',
    " :><0=48@>2:5": '–í –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–µ',
    "=50:B82=>< AB0BCA5": '–Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–º —Å—Ç–∞—Ç—É—Å–µ',
    "> 1>;L=8G=K9": '–ù–∞ –±–æ–ª—å–Ω–∏—á–Ω—ã–π',
    "<4": 'üèñÔ∏è',
    ">": 'üè•',
    "": '‚úàÔ∏è',
    "": '‚úÖ',
    "S": '‚ùì',
}

for corrupted, fixed in corrupted_replacements.items():
    content = content.replace(corrupted, fixed)

with open('src/handlers/manager.py', 'w', encoding='utf-8') as f:
    f.write(content)

print("‚úÖ Fixed src/handlers/manager.py")

# Now test again
import subprocess
result = subprocess.run(['python3', 'test_imports.py'], capture_output=True, text=True)
print("\n" + result.stdout)
if result.returncode != 0:
    print(result.stderr)